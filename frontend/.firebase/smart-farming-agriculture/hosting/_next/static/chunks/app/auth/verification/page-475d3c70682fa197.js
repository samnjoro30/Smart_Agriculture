(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[489],{3081:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});let n=r(3464).A.create({baseURL:"https://smart-agriculture-21dt.onrender.com/",withCredentials:!0});n.interceptors.request.use(e=>(e.withCredentials=!0,e),e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{let t=e.config;if(t.url.includes("/auth/refresh"))return window.location.href="/auth/login",Promise.reject(e);if(e.response&&401===e.response.status)try{return await n.post("/auth/refresh",{},{withCredentials:!0}),n(t)}catch(e){return window.location.href="/auth/login",Promise.reject(e)}return Promise.reject(e)}),n.defaults.withCredentials=!0;let i=n},5695:(e,t,r)=>{"use strict";var n=r(8999);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},7992:(e,t,r)=>{Promise.resolve().then(r.bind(r,8460))},8460:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(5155),i=r(2115),s=r(5695),a=r(3081);let o=()=>{let e=(0,s.useRouter)(),[t,r]=(0,i.useState)(""),[o,c]=(0,i.useState)(""),[l,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!1),[h,f]=(0,i.useState)({email:"",otp:""}),g=e=>{let{name:t,value:r}=e.target;f(e=>({...e,[t]:r}))},x=async t=>{t.preventDefault(),d(!0),r(""),c("");try{let t=await a.A.post("/auth/verification",h);c(t.data.message||"Verification successfull. Redirecting..."),e.push("/auth/login")}catch(e){console.error("Error occurred during verification",e instanceof Error?e:Error(String(e))),r("Error Occured during verification, try checking verification code "),setTimeout(()=>r(""),3e3)}finally{d(!1)}},p=async()=>{if(!h.email){r("Must have entered email for resend code"),setTimeout(()=>r(""),3e3);return}m(!0),r(""),c("");try{let e=await a.A.post("/auth/resend-verificion-code",{email:h.email});c(e.data.message||"Resend code successful")}catch(e){console.error("Error occurred while resending code",e instanceof Error?e:Error(String(e))),r("Failed to resend verification code. Please try again."),setTimeout(()=>r(""),3e3)}finally{m(!1)}};return(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-green-50 p-6",children:(0,n.jsxs)("div",{className:"w-full max-w-md bg-white shadow-lg rounded-xl p-8 space-y-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-green-800 text-center",children:"Email Verification"}),(0,n.jsx)("p",{className:"text-sm text-green-700 text-center",children:"Enter the verification code sent to your email."}),(0,n.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-green-700 mb-1",children:"Email:"}),(0,n.jsx)("input",{type:"email",name:"email",value:h.email,onChange:g,required:!0,className:"w-full px-4 py-2 border border-green-300 bg-green-50 text-green-900 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"you@gmail.com"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-green-700 mb-1",children:"Verification Code (OTP):"}),(0,n.jsx)("input",{type:"text",name:"otp",value:h.otp,onChange:g,required:!0,className:"w-full px-4 py-2 border border-green-300 bg-green-50 text-green-900 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"123456"})]}),(0,n.jsx)("button",{type:"submit",disabled:l,className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md transition duration-300 ".concat(l?"opacity-70 cursor-not-allowed":""),children:l?"Verifying...":"Verify"})]}),(0,n.jsx)("div",{className:"text-centre mt-4",children:(0,n.jsx)("button",{onClick:p,disabled:u,className:"text-green-600 hover:underline text-sm disabled:opacity-50",children:u?"Resending ...":"Resend verification code"})}),o&&(0,n.jsx)("p",{className:"text-center text-green-700 font-medium",children:o}),t&&(0,n.jsx)("p",{className:"text-center text-red-600 font-medium",children:t})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(7992)),_N_E=e.O()}]);